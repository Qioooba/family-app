# 🤖 AI助手功能 - 待开发

## 功能概述
智能AI助手，提供对话式交互和家庭生活顾问服务。

## 功能清单

### 1. 对话式交互
- [ ] 自然语言理解
  - 理解用户提问："今晚吃什么？"
  - 理解上下文：记住对话历史
  - 多轮对话支持：追问、澄清、修正
  
- [ ] 语音识别输入
  - 语音转文字
  - 方言识别优化
  - 语音唤醒功能

### 2. 智能场景

#### 2.1 菜谱顾问
- [ ] 根据冰箱食材推荐菜谱
- [ ] 根据口味偏好推荐
- [ ] 根据营养需求推荐（减脂/增肌/控糖）
- [ ] 根据烹饪时间推荐（快手菜/大餐）
- [ ] 烹饪步骤语音指导

#### 2.2 营养师
- [ ] 分析每日饮食营养摄入
- [ ] 给出营养补充建议
- [ ] 识别营养缺失预警
- [ ] 生成个性化饮食方案
- [ ] 健康风险评估

#### 2.3 购物助手
- [ ] 根据菜谱生成购物清单
- [ ] 库存不足自动提醒采购
- [ - [ ] 价格比较和优惠推荐
- [ ] 食材替代建议

#### 2.4 生活管家
- [ ] 智能提醒待办事项
- [ ] 纪念日提前提醒
- [ ] 天气联动建议（雨天提醒带伞/降温提醒加衣）
- [ ] 家庭日程智能排期

#### 2.5 家庭关系顾问（轻量）
- [ ] 亲子活动建议
- [ ] 夫妻关系维护建议
- [ ] 家庭冲突调解话术
- [ ] 节日/纪念日礼物推荐

### 3. 主动服务

#### 3.1 早安日报
- [ ] 每天早上推送今日概览
  - 今日待办事项
  - 今日天气和穿衣建议
  - 今日菜谱推荐
  - 今日纪念日提醒
  - 家庭动态摘要

#### 3.2 晚安总结
- [ ] 晚上推送今日完成回顾
  - 任务完成情况统计
  - 饮食摄入总结
  - 明日待办预览
  - 健康数据日报

#### 3.3 异常提醒
- [ ] 发现异常主动提醒
  - 连续3天外卖提醒
  - 食材即将过期提醒
  - 任务逾期提醒升级
  - 家庭成员健康数据异常

### 4. 技术实现

#### 4.1 需要接入的AI服务
```yaml
# DeepSeek API
api-key: your-deepseek-key
api-url: https://api.deepseek.com/v1/chat/completions
model: deepseek-chat

# 文心一言 API（备选）
api-key: your-wenxin-key
api-url: https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions

# 通义千问 API（备选）
api-key: your-qwen-key
api-url: https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation
```

#### 4.2 后端API设计
```java
// AI对话接口
POST /api/ai/chat
Request: {
  "message": "今晚吃什么？",
  "context": ["之前的对话历史"],
  "familyId": 123,
  "userId": 456
}
Response: {
  "reply": "根据您冰箱里的土豆和牛肉，推荐番茄土豆炖牛肉...",
  "suggestions": ["菜谱1", "菜谱2"],
  "actions": ["查看详情", "加入购物清单"]
}

// 语音输入接口
POST /api/ai/voice
Request: {
  "audioBase64": "...",
  "format": "mp3"
}
Response: {
  "text": "帮我记录一下，早餐吃了两个包子",
  "intent": "add_diet_record",
  "entities": {
    "meal": "breakfast",
    "food": "包子",
    "quantity": 2
  }
}

// 获取AI日报
GET /api/ai/daily-report?userId=123&date=2025-02-21
Response: {
  "greeting": "早上好！",
  "weather": "今天晴，15-22°C",
  "tasks": ["上午9点开会", "下午买菜"],
  "recipeSuggestion": "推荐：红烧肉",
  "anniversary": "距离妈妈生日还有3天"
}
```

#### 4.3 前端页面
```
frontend/src/pages/ai/
├── index.vue          # AI助手首页
├── chat.vue           # 对话页面
├── voice.vue          # 语音输入页面
└── suggestions.vue    # 智能建议页面
```

### 5. 数据库表
```sql
-- AI对话历史表
CREATE TABLE ai_chat_history (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    family_id BIGINT,
    session_id VARCHAR(64) COMMENT '会话ID',
    role ENUM('user', 'assistant') COMMENT '角色',
    content TEXT COMMENT '对话内容',
    intent VARCHAR(50) COMMENT '意图识别',
    entities JSON COMMENT '实体提取',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_user_session (user_id, session_id),
    INDEX idx_create_time (create_time)
);

-- AI使用统计表
CREATE TABLE ai_usage_stats (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    date DATE NOT NULL,
    chat_count INT DEFAULT 0 COMMENT '对话次数',
    voice_count INT DEFAULT 0 COMMENT '语音次数',
    token_used INT DEFAULT 0 COMMENT 'Token使用量',
    UNIQUE KEY uk_user_date (user_id, date)
);
```

## 开发优先级
1. P0 - 基础对话功能（DeepSeek接入）
2. P1 - 菜谱推荐场景
3. P1 - 早安日报
4. P2 - 语音识别
5. P2 - 营养师场景
6. P3 - 其他场景

## 预估开发时间
- 后端API开发：3天
- AI服务接入：2天
- 前端页面开发：3天
- 联调测试：2天
- **总计：约10天**
