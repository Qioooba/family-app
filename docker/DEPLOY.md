# å®¶åº­å°ç¨‹åº - Docker éƒ¨ç½²æ–¹æ¡ˆ

> çŠ¶æ€: âœ… éƒ¨ç½²å®Œæˆ
> å®Œæˆæ—¥æœŸ: 2026-02-22

## éƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Docker Network                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Nginx     â”‚  â”‚   MySQL     â”‚  â”‚     Redis       â”‚  â”‚
â”‚  â”‚   (å‰ç«¯)    â”‚  â”‚   (æ•°æ®åº“)   â”‚  â”‚    (ç¼“å­˜)       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              åç«¯å¾®æœåŠ¡ (å¤šä¸ªå®¹å™¨)                â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  Gatewayâ”‚ â”‚  User   â”‚ â”‚ Family  â”‚ â”‚ Task   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Serviceâ”‚ â”‚ Service â”‚ â”‚ Service â”‚ â”‚Service â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿å·²å®‰è£…ï¼š
- Docker 20.10+
- Docker Compose 2.0+

### 2. å…‹éš†ä»£ç 

```bash
git clone https://github.com/Qioooba/family-app.git
cd family-app
```

### 3. å¯åŠ¨æœåŠ¡

```bash
cd docker

# å¤åˆ¶ç¯å¢ƒå˜é‡é…ç½®
cp .env.example .env

# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d --build

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢æœåŠ¡
docker-compose down
```

### 4. è®¿é—®æœåŠ¡

- å‰ç«¯é¡µé¢: http://localhost
- åç«¯API: http://localhost:8080
- APIæ–‡æ¡£: http://localhost:8080/swagger-ui.html

## âœ… éƒ¨ç½²çŠ¶æ€

| æœåŠ¡ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| MySQL | âœ… è¿è¡Œä¸­ | æ•°æ®åº“æœåŠ¡æ­£å¸¸ |
| Redis | âœ… è¿è¡Œä¸­ | ç¼“å­˜æœåŠ¡æ­£å¸¸ |
| Gateway | âœ… è¿è¡Œä¸­ | APIç½‘å…³æ­£å¸¸ |
| User Service | âœ… è¿è¡Œä¸­ | ç”¨æˆ·æœåŠ¡æ­£å¸¸ |
| Family Service | âœ… è¿è¡Œä¸­ | å®¶åº­æœåŠ¡æ­£å¸¸ |
| Task Service | âœ… è¿è¡Œä¸­ | ä»»åŠ¡æœåŠ¡æ­£å¸¸ |
| å…¶ä»–æœåŠ¡ | âœ… å…¨éƒ¨è¿è¡Œ | æ‰€æœ‰å¾®æœåŠ¡æ­£å¸¸ |

## æœåŠ¡è¯´æ˜

| æœåŠ¡ | ç«¯å£ | è¯´æ˜ |
|------|------|------|
| nginx | 80 | å‰ç«¯é™æ€é¡µé¢ |
| gateway | 8080 | APIç½‘å…³ |
| user-service | åŠ¨æ€ | ç”¨æˆ·æœåŠ¡ |
| family-service | åŠ¨æ€ | å®¶åº­æœåŠ¡ |
| task-service | åŠ¨æ€ | ä»»åŠ¡æœåŠ¡ |
| mysql | 3306 | æ•°æ®åº“ |
| redis | 6379 | ç¼“å­˜ |

## ç¯å¢ƒå˜é‡é…ç½®

å¤åˆ¶ `.env.example` ä¸º `.env` å¹¶ä¿®æ”¹ï¼š

```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶
```

### å…³é”®é…ç½®é¡¹

```env
# æ•°æ®åº“
MYSQL_ROOT_PASSWORD=your_mysql_password
MYSQL_DATABASE=family_app

# Redis
REDIS_PASSWORD=your_redis_password

# JWTå¯†é’¥
JWT_SECRET=your_jwt_secret_key
```

## ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### 1. ä¿®æ”¹é…ç½®

ç¼–è¾‘ `docker-compose.yml`ï¼š
- ä¿®æ”¹ç«¯å£æ˜ å°„
- é…ç½®åŸŸåSSLè¯ä¹¦
- è®¾ç½®èµ„æºé™åˆ¶

### 2. æ„å»ºç”Ÿäº§é•œåƒ

```bash
docker-compose build
docker-compose up -d
```

### 3. æ•°æ®åº“åˆå§‹åŒ–

é¦–æ¬¡éƒ¨ç½²è‡ªåŠ¨åˆå§‹åŒ–æ•°æ®åº“ã€‚

## ç›‘æ§ä¸æ—¥å¿—

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€

```bash
# æ‰€æœ‰å®¹å™¨çŠ¶æ€
docker-compose ps

# èµ„æºä½¿ç”¨æƒ…å†µ
docker stats
```

### æŸ¥çœ‹æ—¥å¿—

```bash
# æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs

# ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs -f gateway-service

# æœ€è¿‘100è¡Œæ—¥å¿—
docker-compose logs --tail=100
```

## å¤‡ä»½ä¸æ¢å¤

### æ•°æ®åº“å¤‡ä»½

```bash
# å¤‡ä»½MySQL
docker exec family-app-mysql mysqldump -uroot -p family_app > backup.sql
```

### æ•°æ®æ¢å¤

```bash
# æ¢å¤MySQL
docker exec -i family-app-mysql mysql -uroot -p family_app < backup.sql
```

## å¸¸è§é—®é¢˜

### Q1: ç«¯å£è¢«å ç”¨

ä¿®æ”¹ `docker-compose.yml` ä¸­çš„ç«¯å£æ˜ å°„ï¼š
```yaml
ports:
  - "8080:8080"  # æ”¹ä¸º "8081:8080" æˆ–å…¶ä»–å¯ç”¨ç«¯å£
```

### Q2: å®¹å™¨å¯åŠ¨å¤±è´¥

æ£€æŸ¥æ—¥å¿—ï¼š
```bash
docker-compose logs service-name
```

## æ›´æ–°éƒ¨ç½²

### æ›´æ–°ä»£ç åé‡æ–°éƒ¨ç½²

```bash
# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
cd docker
docker-compose down
docker-compose up -d --build
```

## å®‰å…¨å»ºè®®

1. **ä¿®æ”¹é»˜è®¤å¯†ç ** - æ‰€æœ‰æœåŠ¡çš„é»˜è®¤å¯†ç å¿…é¡»ä¿®æ”¹
2. **ä½¿ç”¨HTTPS** - ç”Ÿäº§ç¯å¢ƒå¿…é¡»é…ç½®SSLè¯ä¹¦
3. **é™åˆ¶ç«¯å£æš´éœ²** - ä»…æš´éœ²å¿…è¦çš„ç«¯å£
4. **å®šæœŸæ›´æ–°é•œåƒ** - åŠæ—¶æ›´æ–°åŸºç¡€é•œåƒä¿®å¤å®‰å…¨æ¼æ´

## éƒ¨ç½²éªŒè¯

âœ… MySQLè¿æ¥æ­£å¸¸
âœ… Redisè¿æ¥æ­£å¸¸
âœ… GatewayæœåŠ¡å¯åŠ¨æˆåŠŸ
âœ… æ‰€æœ‰å¾®æœåŠ¡æ³¨å†ŒæˆåŠŸ
âœ… å‰ç«¯é¡µé¢å¯è®¿é—®
âœ… APIæ¥å£å“åº”æ­£å¸¸

---

**âœ… Dockeréƒ¨ç½²å®Œæˆï¼å…¨éƒ¨æœåŠ¡è¿è¡Œæ­£å¸¸ï¼**

*æœ€åæ›´æ–°: 2026-02-22*
