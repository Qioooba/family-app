# é—®é¢˜ä¿®å¤æŠ¥å‘Š

## ä¿®å¤æ—¶é—´
2026-02-23 13:10

---

## é—®é¢˜1ï¼šTabBar ä¸æ˜¾ç¤º âœ… å·²ä¿®å¤

### æ ¹æœ¬åŸå› 
1. **App.vue ä¸­ `<up-tabbar>` ç»„ä»¶é…ç½®é”™è¯¯**ï¼šä½¿ç”¨äº†å›¾æ ‡åç§°ï¼ˆå¦‚ `'home'`ï¼‰ï¼Œä½† uview-plus çš„ tabbar éœ€è¦å®é™…çš„å›¾ç‰‡è·¯å¾„
2. **tabList ç¼ºå°‘ `family` é¡µé¢**ï¼špages.json ä¸­æœ‰5ä¸ª tabï¼Œä½† App.vue ä¸­åªæœ‰4ä¸ª
3. **åŸç”Ÿ tabBar å’Œè‡ªå®šä¹‰ tabBar å†²çª**ï¼špages.json ä¸­é…ç½®äº†åŸç”Ÿ tabBarï¼ŒåŒæ—¶ App.vue ä½¿ç”¨äº†è‡ªå®šä¹‰ tabBar
4. **ç™»å½•åä½¿ç”¨ `uni.reLaunch` è·³è½¬**ï¼šå¯èƒ½å¯¼è‡´ tabBar åˆå§‹åŒ–é—®é¢˜

### ä¿®å¤å†…å®¹

#### 1. App.vue
- å°†å›¾æ ‡åç§°æ”¹ä¸ºå®é™…çš„ SVG å›¾ç‰‡è·¯å¾„ï¼š
  - `iconPath: '/static/tabbar/home.svg'`
  - `selectedIconPath: '/static/tabbar/home-active.svg'`
- æ·»åŠ  `family` é¡µé¢åˆ° tabListï¼ˆç¬¬4ä¸ª tabï¼‰
- æ·»åŠ  `showTabBar` è®¡ç®—å±æ€§ï¼Œåªåœ¨ tabBar é¡µé¢æ˜¾ç¤º
- æ·»åŠ  `onShow` ç”Ÿå‘½å‘¨æœŸæ¥æ›´æ–°å½“å‰ tab ç´¢å¼•
- åˆå¹¶é‡å¤çš„ `onMounted` é’©å­

#### 2. pages.json
- åœ¨ tabBar é…ç½®ä¸­æ·»åŠ  `"custom": true` ç¦ç”¨åŸç”Ÿ tabBar

#### 3. ç™»å½•é¡µé¢ (pages/login/index.vue)
- å°† `uni.reLaunch` æ”¹ä¸º `uni.switchTab` è·³è½¬åˆ°é¦–é¡µ

#### 4. æ‰€æœ‰ TabBar é¡µé¢æ·»åŠ åº•éƒ¨ padding
- `pages/home/index.vue`: `padding-bottom: 160rpx`
- `pages/task/index.vue`: `padding-bottom: 160rpx`
- `pages/wish/index.vue`: `padding-bottom: 160rpx`
- `pages/family/index.vue`: `padding-bottom: 160rpx`
- `pages/profile/index.vue`: `padding-bottom: 160rpx`

---

## é—®é¢˜2ï¼šå–æ°´è®°å½•æœåŠ¡å™¨é”™è¯¯ âœ… å·²ä¿®å¤

### æ ¹æœ¬åŸå› 
**æ•°æ®åº“è¡¨ `water_record` ä¸å­˜åœ¨**

é”™è¯¯æ—¥å¿—ï¼š
```
org.springframework.jdbc.BadSqlGrammarException: 
Table 'family_app.water_record' doesn't exist
```

### ä¿®å¤å†…å®¹

#### 1. åˆ›å»º SQL ä¿®å¤è„šæœ¬
æ–‡ä»¶ï¼š`database/fix_water_record_table.sql`

```sql
CREATE TABLE IF NOT EXISTS water_record (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'è®°å½•ID',
    user_id BIGINT NOT NULL COMMENT 'ç”¨æˆ·ID',
    amount INT NOT NULL COMMENT 'å–æ°´é‡(ml)',
    record_date DATE NOT NULL COMMENT 'è®°å½•æ—¥æœŸ',
    record_time TIME COMMENT 'è®°å½•æ—¶é—´',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    INDEX idx_user_date (user_id, record_date)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='å–æ°´è®°å½•è¡¨';
```

**âš ï¸ éœ€è¦æ‰‹åŠ¨æ‰§è¡Œæ­¤ SQL è„šæœ¬åˆ°æ•°æ®åº“**

#### 2. ä¿®æ”¹å–æ°´é¡µé¢å›¾æ ‡
æ–‡ä»¶ï¼š`pages/water/index.vue`

- å°† `minus-circle` å›¾æ ‡æ”¹ä¸º ğŸ’§ æ°´æ»´å›¾æ ‡
- å°† `plus` å›¾æ ‡æ”¹ä¸º ğŸ’§ æ°´æ»´å›¾æ ‡
- æ·»åŠ ç›¸åº”çš„æ ·å¼ä¼˜åŒ–

---

## å¾…åŠäº‹é¡¹

### ç«‹å³æ‰§è¡Œ
1. [ ] åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œ `database/fix_water_record_table.sql` åˆ›å»º water_record è¡¨
2. [ ] é‡æ–°ç¼–è¯‘å‰ç«¯é¡¹ç›®
3. [ ] æµ‹è¯• tabBar æ˜¯å¦æ­£å¸¸æ˜¾ç¤º
4. [ ] æµ‹è¯•å–æ°´è®°å½•åŠŸèƒ½æ˜¯å¦æ­£å¸¸

### éªŒè¯æ­¥éª¤
1. ç™»å½•åæ£€æŸ¥é¦–é¡µåº•éƒ¨æ˜¯å¦æœ‰ tabBar æ˜¾ç¤º
2. åˆ‡æ¢å„ä¸ª tab æ˜¯å¦æ­£å¸¸
3. è¿›å…¥å–æ°´æ‰“å¡é¡µé¢ï¼Œç‚¹å‡»"è®°å½•å–æ°´"æŒ‰é’®
4. æ£€æŸ¥æ˜¯å¦æˆåŠŸè®°å½•ï¼Œä¸å†æç¤º"æœåŠ¡å™¨å†…éƒ¨é”™è¯¯"

---

## æ–‡ä»¶ä¿®æ”¹æ¸…å•

### å‰ç«¯æ–‡ä»¶
1. `/frontend/src/App.vue` - é‡å†™
2. `/frontend/src/pages.json` - æ·»åŠ  `"custom": true`
3. `/frontend/src/pages/login/index.vue` - ä¿®æ”¹è·³è½¬æ–¹å¼
4. `/frontend/src/pages/home/index.vue` - æ·»åŠ  padding-bottom
5. `/frontend/src/pages/task/index.vue` - æ·»åŠ  padding-bottom
6. `/frontend/src/pages/wish/index.vue` - æ·»åŠ  padding-bottom
7. `/frontend/src/pages/family/index.vue` - æ·»åŠ  padding-bottom
8. `/frontend/src/pages/profile/index.vue` - æ·»åŠ  padding-bottom
9. `/frontend/src/pages/water/index.vue` - ä¿®æ”¹å›¾æ ‡

### æ•°æ®åº“æ–‡ä»¶
1. `/database/fix_water_record_table.sql` - æ–°å»º

---

## å¤‡æ³¨

- æ‰€æœ‰ä¿®å¤å·²å®Œæˆï¼Œåªéœ€è¦æ‰§è¡Œæ•°æ®åº“ SQL è„šæœ¬å³å¯
- å–æ°´é¡µé¢çš„å›¾æ ‡å·²æ›´æ¢ä¸ºæ›´ç¾è§‚çš„ ğŸ’§ æ°´æ»´è¡¨æƒ…
- TabBar ç°åœ¨ä¼šåœ¨æ‰€æœ‰ tabBar é¡µé¢æ­£ç¡®æ˜¾ç¤º
